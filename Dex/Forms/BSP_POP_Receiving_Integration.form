Form	"BSP_POP_Receiving_Integration"
{
	Commands
	{
	}
	ConfigurableMenus	"false"
	Constants
	{
	}
	Datatypes
	{
		Datatype	"DocumentFilter"		
		{
			Control	"DropDownList"
			Sort	"false"
			StaticType	"Text"
			~StaticItems
			{
				TextItem	"00001"				
				{
					Item	"by Receipt Number"
				}
				TextItem	"00002"				
				{
					Item	"by Document Date"
				}
			}
		}
		Datatype	"FillTempFile"		
		{
			Control	"Boolean"
		}
		Datatype	"Selected"		
		{
			Control	"CheckBox"
			StaticType	"Text"
			~StaticItems
			{
			}
		}
		Datatype	"Send to Powerhouse"		
		{
			Control	"PushButton"
			DefaultDown	"00000"
			DefaultMouseOver	"00000"
			DefaultUp	"00002"
			Prompt	"Send to Powerhouse"
			PromptDown	""
			PromptMouseOver	""
			StaticType	"Picture"
			~ItemImages
			{
				PictItem	"00001"				
				{
					Item	"WindowToolbar_Post_PB_Up"
				}
				PictItem	"00002"				
				{
					Item	"WindowToolbar_Transfer_PB_Up"
				}
			}
		}
	}
	EventPost	""
	EventPre	""
	Fields
	{
		Field	"DocumentDateFrom"		
		{
			ArraySize	"0"
			Datatype	"DATE"
			LookupForm	""
			PhysicalName	""
		}
		Field	"DocumentDateTo"		
		{
			ArraySize	"0"
			Datatype	"DATE"
			LookupForm	""
			PhysicalName	""
		}
		Field	"DocumentFilter"		
		{
			ArraySize	"0"
			Datatype	"(L) DocumentFilter"
			LookupForm	""
			PhysicalName	""
		}
		Field	"FillTempFile"		
		{
			ArraySize	"0"
			Datatype	"(L) FillTempFile"
			LookupForm	""
			PhysicalName	""
		}
		Field	"ReceiptFrom"		
		{
			ArraySize	"0"
			Datatype	"STR17_POP_Number"
			LookupForm	""
			PhysicalName	""
		}
		Field	"ReceiptTo"		
		{
			ArraySize	"0"
			Datatype	"STR17_POP_Number"
			LookupForm	""
			PhysicalName	""
		}
		Field	"Selected"		
		{
			ArraySize	"0"
			Datatype	"(L) Selected"
			LookupForm	""
			PhysicalName	""
		}
		Field	"Send to Powerhouse"		
		{
			ArraySize	"0"
			Datatype	"(L) Send to Powerhouse"
			LookupForm	""
			PhysicalName	""
		}
		Field	"VendorDocNumFrom"		
		{
			ArraySize	"0"
			Datatype	"STR20_Document_Number"
			LookupForm	""
			PhysicalName	""
		}
		Field	"VendorDocNumTo"		
		{
			ArraySize	"0"
			Datatype	"STR20_Document_Number"
			LookupForm	""
			PhysicalName	""
		}
	}
	Menus
	{
	}
	Series	"Purchasing"
	Tables
	{
		FormTable	"BSP_Powerhouse_Receiving_HDR"		
		{
			AutoOpen	"false"
			CursorBlockSize	"0"
			OpenMode	"ReadWrite"
			Position	"4"
			Table	"BSP_Powerhouse_Receiving_HDR"
		}
		FormTable	"BSP_Powerhouse_Receiving_LINE"		
		{
			AutoOpen	"false"
			CursorBlockSize	"0"
			OpenMode	"ReadWrite"
			Position	"5"
			Table	"BSP_Powerhouse_Receiving_LINE"
		}
		FormTable	"BSP_Powerhouse_Receiving_TMP"		
		{
			AutoOpen	"false"
			CursorBlockSize	"0"
			OpenMode	"ReadWrite"
			Position	"6"
			Table	"BSP_Powerhouse_Receiving_TMP"
		}
		FormTable	"BSP_Powerhouse_Receiving_Transfer"		
		{
			AutoOpen	"false"
			CursorBlockSize	"0"
			OpenMode	"ReadWrite"
			Position	"2"
			Table	"BSP_Powerhouse_Receiving_Transfer"
		}
		FormTable	"POP_ReceiptHist"		
		{
			AutoOpen	"false"
			CursorBlockSize	"0"
			OpenMode	"ReadWrite"
			Position	"1"
			Table	"POP_ReceiptHist"
		}
		FormTable	"POP_ReceiptLineHist"		
		{
			AutoOpen	"false"
			CursorBlockSize	"0"
			OpenMode	"ReadWrite"
			Position	"3"
			Table	"POP_ReceiptLineHist"
		}
	}
	Windows
	{
		Window	"BSP_POP_Receiving_Integration"		
		{
			AutoLinkTable	""
			AutoOpen	"true"
			BackGround	"true"
			CloseBox	"true"
			ControlArea	"true"
			DisplayName	"Powerhouse Receiving Integration"
			EventActivate	""
			EventContextMenu	""
			EventPost	""
			EventPre	"BSP_POP_Receiving_Integration_WIN_PRE"
			EventPrint	""
			Fields
			{
				WindowControl	"(L) DocumentDateFrom"				
				{
					Appearance	"2D Border"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"Date"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) DocumentDateFrom"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"440"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"144"
					TabStop	"true"
					Tag	"24"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"2"
					Zoom	"false"
				}
				WindowControl	"(L) DocumentDateTo"				
				{
					Appearance	"2D Border"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"Date"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) DocumentDateTo"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"440"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"144"
					TabStop	"true"
					Tag	"26"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"4"
					Zoom	"false"
				}
				WindowControl	"(L) DocumentFilter"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					ControlType	"DropDownList"
					DisableLookup	"false"
					Editable	"true"
					EventChange	"BSP_POP_Receiving_Integration l_DocumentFilter_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) DocumentFilter"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"104"
					PositionTop	"34"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"192"
					TabStop	"true"
					Tag	"22"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					VisibleItems	"8"
					ZOrder	"0"
				}
				WindowControl	"(L) FillTempFile"				
				{
					Appearance	"2D Border"
					AutoCopy	"false"
					BackColor	"Yellow"
					ControlType	"Boolean"
					EventChange	"BSP_POP_Receiving_Integration l_FillTempFile_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					Field	"(L) FillTempFile"
					FontColor	"System"
					PositionLeft	"24"
					PositionTop	"406"
					SavedOnRestart	"false"
					SizeHeight	"20"
					SizeWidth	"208"
					Tag	"18"
					ZOrder	"18"
				}
				WindowControl	"(L) ReceiptFrom"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) ReceiptFrom"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"440"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"13"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"6"
					Zoom	"false"
				}
				WindowControl	"(L) ReceiptTo"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) ReceiptTo"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"440"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"14"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"7"
					Zoom	"false"
				}
				WindowControl	"(L) Send to Powerhouse"				
				{
					Alignment	"center"
					Appearance	"3D Highlight"
					BackColor	"System - Toolbar"
					Border	"true"
					ButtonStyle	"TextOnRight"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_POP_Receiving_Integration l_Send to Powerhouse_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) Send to Powerhouse"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"0"
					PositionTop	"0"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"24"
					SizeWidth	"144"
					TabStop	"true"
					Tag	"2"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"8"
					Zoom	"false"
				}
				WindowControl	"(L) VendorDocNumFrom"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) VendorDocNumFrom"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"440"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"19"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"1"
					Zoom	"false"
				}
				WindowControl	"(L) VendorDocNumTo"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) VendorDocNumTo"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"440"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"20"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"3"
					Zoom	"false"
				}
				ScrollingWindow	"0011-BSP_POP_Receiving_Integration_Scrolling"				
				{
					AltLineColor	"true"
					Appearance	"2D Border"
					BackColor	"System - List Line2"
					BigLineItem	"19"
					DefaultDblClick	"false"
					EventLineChange	"BSP_POP_Receiving_Integration_Scrolling SCROLL_CHG"
					EventLineContextMenu	""
					EventLineDelete	""
					EventLineFill	""
					EventLineInsert	""
					EventLinePost	""
					EventLinePre	""
					Fields
					{
						WindowLine	"1"						
						{
							Appearance	"3D Border"
							LineColor	"System"
							LineSize	"1"
							PositionLeft	"0"
							PositionTop	"19"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SizeHeight	"0"
							SizeWidth	"592"
							ZOrder	"0"
						}
						WindowLine	"11"						
						{
							Appearance	"3D Border"
							LineColor	"System"
							LineSize	"1"
							PositionLeft	"448"
							PositionTop	"0"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SizeHeight	"20"
							SizeWidth	"0"
							ZOrder	"8"
						}
						WindowLine	"3"						
						{
							Appearance	"3D Border"
							LineColor	"System"
							LineSize	"1"
							PositionLeft	"64"
							PositionTop	"0"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SizeHeight	"20"
							SizeWidth	"0"
							ZOrder	"2"
						}
						WindowLine	"6"						
						{
							Appearance	"3D Border"
							LineColor	"System"
							LineSize	"1"
							PositionLeft	"176"
							PositionTop	"0"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SizeHeight	"20"
							SizeWidth	"0"
							ZOrder	"3"
						}
						WindowLine	"8"						
						{
							Appearance	"3D Border"
							LineColor	"System"
							LineSize	"1"
							PositionLeft	"272"
							PositionTop	"0"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SizeHeight	"20"
							SizeWidth	"0"
							ZOrder	"5"
						}
						WindowControl	"BSP_Include"						
						{
							Alignment	"left"
							Appearance	"3D Border"
							AutoCopy	"true"
							BackColor	"System - Window Background"
							Border	"true"
							ButtonStyle	"Standard"
							ControlType	"CheckBox"
							Editable	"true"
							EventChange	""
							EventContextMenu	""
							EventMouseEnter	""
							EventMouseExit	""
							EventOther	""
							EventPost	""
							EventPre	""
							Field	"BSP_Include"
							Font	"System (generic)"
							FontBold	"false"
							FontColor	"System - Window Text"
							FontItalic	"false"
							FontUnderline	"false"
							HyperSpace	"false"
							LinkedLookup	"0"
							LinkedPrompt	"0"
							Pattern	"(none)"
							PatternColor	"White"
							PatternSelect	"50% Shading"
							PositionLeft	"32"
							PositionTop	"0"
							Required	"false"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SavedOnRestart	"false"
							SetChangeFlag	"true"
							SizeHeight	"20"
							SizeWidth	"32"
							TabStop	"true"
							Tag	"15"
							Tooltip	""
							UseUniqueHelp	"true"
							Visible	"true"
							ZOrder	"9"
						}
						WindowControl	"POP Receipt Number"						
						{
							Alignment	"left"
							Appearance	"2D Border"
							AutoComplete	"false"
							AutoCopy	"true"
							BackColor	"System - Window Background"
							Border	"false"
							ControlType	"String"
							DisableLookup	"false"
							Editable	"false"
							EventChange	""
							EventContextMenu	""
							EventMouseEnter	""
							EventMouseExit	""
							EventOther	""
							EventPost	""
							EventPre	""
							Field	"POP Receipt Number"
							Font	"System (generic)"
							FontBold	"false"
							FontColor	"System - Window Text"
							FontItalic	"false"
							FontUnderline	"false"
							LinkedFormat	"0"
							LinkedLookup	"0"
							LinkedPrompt	"0"
							Password	"false"
							Pattern	"(none)"
							PatternColor	"White"
							PositionLeft	"64"
							PositionTop	"0"
							ReadingOrder	"LeftToRight"
							Required	"false"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SavedOnRestart	"false"
							SetChangeFlag	"true"
							SizeHeight	"20"
							SizeWidth	"112"
							TabStop	"true"
							Tag	"2"
							Tooltip	""
							UseUniqueHelp	"true"
							Visible	"true"
							ZOrder	"1"
							Zoom	"false"
						}
						WindowControl	"Vendor Document Number"						
						{
							Alignment	"left"
							Appearance	"2D Border"
							AutoComplete	"false"
							AutoCopy	"true"
							BackColor	"System - Window Background"
							Border	"false"
							ControlType	"String"
							DisableLookup	"false"
							Editable	"false"
							EventChange	""
							EventContextMenu	""
							EventMouseEnter	""
							EventMouseExit	""
							EventOther	""
							EventPost	""
							EventPre	""
							Field	"Vendor Document Number"
							Font	"System (generic)"
							FontBold	"false"
							FontColor	"System - Window Text"
							FontItalic	"false"
							FontUnderline	"false"
							LinkedFormat	"0"
							LinkedLookup	"0"
							LinkedPrompt	"0"
							Password	"false"
							Pattern	"(none)"
							PatternColor	"White"
							PositionLeft	"448"
							PositionTop	"0"
							ReadingOrder	"LeftToRight"
							Required	"false"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SavedOnRestart	"false"
							SetChangeFlag	"true"
							SizeHeight	"20"
							SizeWidth	"128"
							TabStop	"true"
							Tag	"10"
							Tooltip	""
							UseUniqueHelp	"true"
							Visible	"true"
							ZOrder	"7"
							Zoom	"false"
						}
						WindowControl	"Vendor ID"						
						{
							Alignment	"left"
							Appearance	"2D Border"
							AutoComplete	"false"
							AutoCopy	"true"
							BackColor	"System - Window Background"
							Border	"false"
							ControlType	"String"
							DisableLookup	"false"
							Editable	"false"
							EventChange	""
							EventContextMenu	""
							EventMouseEnter	""
							EventMouseExit	""
							EventOther	""
							EventPost	""
							EventPre	""
							Field	"Vendor ID"
							Font	"System (generic)"
							FontBold	"false"
							FontColor	"System - Window Text"
							FontItalic	"false"
							FontUnderline	"false"
							LinkedFormat	"0"
							LinkedLookup	"0"
							LinkedPrompt	"0"
							Password	"false"
							Pattern	"(none)"
							PatternColor	"White"
							PositionLeft	"176"
							PositionTop	"0"
							ReadingOrder	"LeftToRight"
							Required	"false"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SavedOnRestart	"false"
							SetChangeFlag	"true"
							SizeHeight	"20"
							SizeWidth	"96"
							TabStop	"true"
							Tag	"7"
							Tooltip	""
							UseUniqueHelp	"true"
							Visible	"true"
							ZOrder	"4"
							Zoom	"false"
						}
						WindowControl	"Vendor Name"						
						{
							Alignment	"left"
							Appearance	"2D Border"
							AutoComplete	"false"
							AutoCopy	"true"
							BackColor	"System - Window Background"
							Border	"false"
							ControlType	"String"
							DisableLookup	"false"
							Editable	"false"
							EventChange	""
							EventContextMenu	""
							EventMouseEnter	""
							EventMouseExit	""
							EventOther	""
							EventPost	""
							EventPre	""
							Field	"Vendor Name"
							Font	"System (generic)"
							FontBold	"false"
							FontColor	"System - Window Text"
							FontItalic	"false"
							FontUnderline	"false"
							LinkedFormat	"0"
							LinkedLookup	"0"
							LinkedPrompt	"0"
							Password	"false"
							Pattern	"(none)"
							PatternColor	"White"
							PositionLeft	"272"
							PositionTop	"0"
							ReadingOrder	"LeftToRight"
							Required	"false"
							ResizeHoriz	"StayLeft"
							ResizeVert	"StayTop"
							SavedOnRestart	"false"
							SetChangeFlag	"true"
							SizeHeight	"20"
							SizeWidth	"176"
							TabStop	"true"
							Tag	"9"
							Tooltip	""
							UseUniqueHelp	"true"
							Visible	"true"
							ZOrder	"6"
							Zoom	"false"
						}
					}
					FontColor	"System - List Line2 Text"
					IgnoreActiveLine	"false"
					LastTag	"15"
					LinkTable	"BSP_Powerhouse_Receiving_TMP"
					LinkTableKey	"1"
					Name	"BSP_POP_Receiving_Integration_Scrolling"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"148"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					ScrollToBottom	"false"
					SizeHeight	"211"
					SizeWidth	"578"
					SmallLineItem	"19"
					WindowType	"Editable"
					ZOrder	"14"
				}
				WindowPrompt	"12"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					BackColor	"System - List Header2"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - List Header2 Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"72"
					PositionTop	"129"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"113"
					Text	"Receipt Number"
					Visible	"true"
					ZOrder	"15"
					Zoom	"false"
				}
				WindowPrompt	"16"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"376"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"64"
					Text	"To:"
					Visible	"true"
					ZOrder	"16"
					Zoom	"false"
				}
				WindowPrompt	"17"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"376"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"64"
					Text	"From:"
					Visible	"true"
					ZOrder	"17"
					Zoom	"false"
				}
				WindowPrompt	"23"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"96"
					Text	"Documents:"
					Visible	"true"
					ZOrder	"19"
					Zoom	"false"
				}
				WindowPrompt	"30"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					BackColor	"System - List Header2"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - List Header2 Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"129"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"65"
					Text	"Include"
					Visible	"true"
					ZOrder	"22"
					Zoom	"false"
				}
				WindowPrompt	"31"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					BackColor	"System - List Header2"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - List Header2 Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"184"
					PositionTop	"129"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"97"
					Text	"Vendor ID"
					Visible	"true"
					ZOrder	"23"
					Zoom	"false"
				}
				WindowPrompt	"32"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					BackColor	"System - List Header2"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - List Header2 Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"280"
					PositionTop	"129"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"177"
					Text	"Name"
					Visible	"true"
					ZOrder	"24"
					Zoom	"false"
				}
				WindowPrompt	"33"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					BackColor	"System - List Header2"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - List Header2 Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"456"
					PositionTop	"129"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"129"
					Text	"Document Number"
					Visible	"true"
					ZOrder	"25"
					Zoom	"false"
				}
				WindowLine	"6"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"144"
					PositionTop	"3"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"16"
					SizeWidth	"0"
					ZOrder	"10"
				}
				WindowLine	"7"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"226"
					PositionTop	"4"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"16"
					SizeWidth	"0"
					ZOrder	"11"
				}
				WindowLine	"8"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"0"
					PositionTop	"24"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"0"
					SizeWidth	"656"
					ZOrder	"12"
				}
				WindowPrompt	"9"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"91"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"96"
					Text	"Container ID"
					Visible	"true"
					ZOrder	"13"
					Zoom	"false"
				}
				WindowControl	"BSP_ContainerID"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"true"
					EventChange	"BSP_POP_Receiving_Integration BSP_ContainerID_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"BSP_ContainerID"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"104"
					PositionTop	"91"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"191"
					TabStop	"true"
					Tag	"10"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"5"
					Zoom	"false"
				}
				WindowControl	"Display Existing Record"				
				{
					Alignment	"left"
					Appearance	"3D Border"
					AutoCopy	"true"
					BackColor	"Yellow"
					Border	"true"
					ButtonStyle	"Standard"
					ControlType	"CheckBox"
					Editable	"true"
					EventChange	"BSP_POP_Receiving_Integration Display Existing Record_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Display Existing Record"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PatternSelect	"50% Shading"
					PositionLeft	"24"
					PositionTop	"433"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"144"
					TabStop	"true"
					Tag	"45"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"false"
					ZOrder	"26"
				}
				WindowControl	"Lookup Button 1"				
				{
					Alignment	"center"
					Appearance	"2D Border"
					BackColor	"System - Button Face"
					Border	"true"
					ButtonStyle	"GraphicOnly"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_POP_Receiving_Integration Lookup Button 1_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Lookup Button 1"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"567"
					PositionTop	"34"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"18"
					TabStop	"false"
					Tag	"27"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"20"
					Zoom	"false"
				}
				WindowControl	"Lookup Button 2"				
				{
					Alignment	"center"
					Appearance	"2D Border"
					BackColor	"System - Button Face"
					Border	"true"
					ButtonStyle	"GraphicOnly"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_POP_Receiving_Integration Lookup Button 2_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Lookup Button 2"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"567"
					PositionTop	"53"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"18"
					TabStop	"false"
					Tag	"28"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"21"
					Zoom	"false"
				}
				WindowControl	"Redisplay Button"				
				{
					Alignment	"center"
					Appearance	"3D Highlight"
					BackColor	"System - Toolbar"
					Border	"true"
					ButtonStyle	"TextOnRight"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_POP_Receiving_Integration Redisplay Button_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Redisplay Button"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"146"
					PositionTop	"0"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"24"
					SizeWidth	"80"
					TabStop	"true"
					Tag	"5"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"9"
					Zoom	"false"
				}
			}
			LastTag	"47"
			Position	"1"
			PositionLeft	"1"
			PositionTop	"1"
			Resizable	"true"
			SizeHeight	"387"
			SizeWidth	"610"
			WindowType	"Primary"
		}
	}
	~EventScripts
	{
		EventScript	"BSP_POP_Receiving_Integration BSP_ContainerID_CHG"		
		{
			Documentation	""
			Script	"{Check if the contain id has already been used. Need to ask if they want to reload}
release table BSP_Powerhouse_Receiving_HDR;
range clear table BSP_Powerhouse_Receiving_HDR;
clear table BSP_Powerhouse_Receiving_HDR;

set BSP_ContainerID of table BSP_Powerhouse_Receiving_HDR to BSP_ContainerID;
get table BSP_Powerhouse_Receiving_HDR;
if err() = OKAY then
	warning \"This Container ID has already been used before. Please use the Powerhouse Receiving Integration Maintenance Window to update the record\";
	restart field;
	abort script;
end if;

"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration Display Existing Record_CHG"		
		{
			Documentation	""
			Script	"{fill window and then disable the \"include\"}
if not empty(BSP_ContainerID) then
	release table BSP_Powerhouse_Receiving_HDR;
	range clear table BSP_Powerhouse_Receiving_HDR;
	clear table BSP_Powerhouse_Receiving_HDR;
	
	set BSP_ContainerID of table BSP_Powerhouse_Receiving_HDR to BSP_ContainerID;
	get table BSP_Powerhouse_Receiving_HDR;
	if err() = OKAY then
		if 'Status Code' of table BSP_Powerhouse_Receiving_HDR = \"X\" then
			set 'Display Existing Record' to true;
		end if;
		
		copy from table BSP_Powerhouse_Receiving_HDR to window BSP_POP_Receiving_Integration;
		
		disable field BSP_Include of window BSP_POP_Receiving_Integration_Scrolling;
		
		release table BSP_Powerhouse_Receiving_TMP;
		range clear table BSP_Powerhouse_Receiving_TMP;
		clear table BSP_Powerhouse_Receiving_TMP;
		
		release table BSP_Powerhouse_Receiving_LINE;
		range clear table BSP_Powerhouse_Receiving_LINE;
		clear table BSP_Powerhouse_Receiving_LINE;
		
		set BSP_ContainerID of table BSP_Powerhouse_Receiving_LINE to BSP_ContainerID;
		clear 'POP Receipt Number' of table BSP_Powerhouse_Receiving_LINE;
		range start table BSP_Powerhouse_Receiving_LINE;
		fill 'POP Receipt Number' of table BSP_Powerhouse_Receiving_LINE;
		range end table BSP_Powerhouse_Receiving_LINE; 
		
		get first table BSP_Powerhouse_Receiving_LINE;
		while err() = OKAY do
			set 'POP Receipt Number' of table BSP_Powerhouse_Receiving_TMP to 'POP Receipt Number' of table BSP_Powerhouse_Receiving_LINE;
			change table BSP_Powerhouse_Receiving_TMP;
			set BSP_Include of table BSP_Powerhouse_Receiving_TMP to true;
			set 'Vendor ID' of table BSP_Powerhouse_Receiving_TMP to 'Vendor ID' of table BSP_Powerhouse_Receiving_LINE;
			set 'Vendor Name' of table BSP_Powerhouse_Receiving_TMP to 'Vendor Name' of table BSP_Powerhouse_Receiving_LINE;
			set 'Vendor Document Number' of table BSP_Powerhouse_Receiving_TMP to 'Vendor Document Number' of table BSP_Powerhouse_Receiving_LINE;
			save table BSP_Powerhouse_Receiving_TMP;
		
			get next table BSP_Powerhouse_Receiving_LINE;
		end while;
		
		fill window BSP_POP_Receiving_Integration_Scrolling;
	else
		set 'Display Existing Record' to false;
		enable field BSP_Include of window BSP_POP_Receiving_Integration_Scrolling;
	end if;
	
end if;
"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration Lookup Button 1_CHG"		
		{
			Documentation	""
			Script	"local	POP_ReceiptLookup	CReceiptLU;	{ Holds defaults for Receipt lookup }

{ Preconditions }
{ None }


CReceiptLU:'Sort By' = 1;
CReceiptLU:Include = INCLUDE_HIST; 
CReceiptLU:'Lock Include' = true;
CReceiptLU:'POP Type' = POP_DOCTYPE_SHIPMENT;

CReceiptLU:'POP Receipt Number' = '(L) ReceiptFrom';

CReceiptLU:'Batch Source' = getmsg(POP_BATCH_SOURCE);
CReceiptLU:'Currency View' = CURRENCYVIEW_FUNCTIONAL;
CReceiptLU:'Caller ID' = WINID_POP_RCPTENTRY;
{CReceiptLU:'Batch Number 2' = 'Batch Number';}


call OpenWindowRet of form POP_Receipt_Lookup, CReceiptLU, '(L) ReceiptFrom';"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration Lookup Button 2_CHG"		
		{
			Documentation	""
			Script	"local	POP_ReceiptLookup	CReceiptLU;	{ Holds defaults for Receipt lookup }

{ Preconditions }
{ None }


CReceiptLU:'Sort By' = 1;
CReceiptLU:Include = INCLUDE_HIST; 
CReceiptLU:'Lock Include' = true;
CReceiptLU:'POP Type' = POP_DOCTYPE_SHIPMENT;

CReceiptLU:'POP Receipt Number' = '(L) ReceiptTo';

CReceiptLU:'Batch Source' = getmsg(POP_BATCH_SOURCE);
CReceiptLU:'Currency View' = CURRENCYVIEW_FUNCTIONAL;
CReceiptLU:'Caller ID' = WINID_POP_RCPTENTRY;
{CReceiptLU:'Batch Number 2' = 'Batch Number';}


call OpenWindowRet of form POP_Receipt_Lookup, CReceiptLU, '(L) ReceiptTo';"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration Redisplay Button_CHG"		
		{
			Documentation	""
			Script	"clear window BSP_POP_Receiving_Integration_Scrolling;

enable field BSP_Include of window BSP_POP_Receiving_Integration_Scrolling;

run script '(L) FillTempFile';"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration l_DocumentFilter_CHG"		
		{
			Documentation	""
			Script	"hide '(L) ReceiptFrom';
hide '(L) ReceiptTo';
hide '(L) VendorDocNumFrom';
hide '(L) VendorDocNumTo';
hide '(L) DocumentDateFrom';
hide '(L) DocumentDateTo';
hide 'Lookup Button 1';
hide 'Lookup Button 2';

clear window BSP_POP_Receiving_Integration_Scrolling;

if '(L) DocumentFilter' = 1 then
	show '(L) ReceiptFrom';
	show '(L) ReceiptTo';
	show 'Lookup Button 1';
	show 'Lookup Button 2';
elseif '(L) DocumentFilter' = 2 then
	show '(L) DocumentDateFrom';
	show '(L) DocumentDateTo';
	hide 'Lookup Button 1';
	hide 'Lookup Button 2';
end if;"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration l_FillTempFile_CHG"		
		{
			Documentation	""
			Script	"release table POP_ReceiptHist;
range clear table POP_ReceiptHist;
clear table POP_ReceiptHist;

release table BSP_Powerhouse_Receiving_TMP;
range clear table BSP_Powerhouse_Receiving_TMP;
clear table BSP_Powerhouse_Receiving_TMP;


if '(L) DocumentFilter' = 1 then
	{Receipt Number}
	
	set 'POP Receipt Number' of table POP_ReceiptHist to '(L) ReceiptFrom';
	range start table POP_ReceiptHist;
	set 'POP Receipt Number' of table POP_ReceiptHist to '(L) ReceiptTo';
	range end table POP_ReceiptHist;
	
	get first table POP_ReceiptHist;
	while err() = OKAY do
		if 'POP Type' of table POP_ReceiptHist = POP_DOCTYPE_SHIPMENT or 'POP Type' of table POP_ReceiptHist = POP_DOCTYPE_SHIPMENT_INVOICE then
			if ReceiptInUse('POP Receipt Number' of table POP_ReceiptHist) of form BSP_POP_Receiving_Integration = false then
				set 'POP Receipt Number' of table BSP_Powerhouse_Receiving_TMP to 'POP Receipt Number' of table POP_ReceiptHist;
				change table BSP_Powerhouse_Receiving_TMP;
				set 'Vendor ID' of table BSP_Powerhouse_Receiving_TMP to 'Vendor ID' of table POP_ReceiptHist;
				set 'Vendor Name' of table BSP_Powerhouse_Receiving_TMP to 'Vendor Name' of table POP_ReceiptHist;
				set 'Vendor Document Number' of table BSP_Powerhouse_Receiving_TMP to 'Vendor Document Number' of table POP_ReceiptHist;
				save table BSP_Powerhouse_Receiving_TMP;
			end if;
		end if;
		
		get next table POP_ReceiptHist;
	end while;

elseif '(L) DocumentFilter' = 2 then
	{Receipt Date}
	set 'Receipt Date' of table POP_ReceiptHist to '(L) DocumentDateFrom';
	clear 'Vendor ID' of table POP_ReceiptHist;
	clear 'POP Receipt Number' of table POP_ReceiptHist;
	range start table POP_ReceiptHist by POP_RcptHistIdx_DocDateByVendID;
	set 'Receipt Date' of table POP_ReceiptHist to '(L) DocumentDateTo';
	fill 'Vendor ID' of table POP_ReceiptHist;
	fill 'POP Receipt Number' of table POP_ReceiptHist;
	range end table POP_ReceiptHist by POP_RcptHistIdx_DocDateByVendID;
	
	get first table POP_ReceiptHist by POP_RcptHistIdx_DocDateByVendID;
	while err() = OKAY do
		if 'POP Type' of table POP_ReceiptHist = POP_DOCTYPE_SHIPMENT or 'POP Type' of table POP_ReceiptHist = POP_DOCTYPE_SHIPMENT_INVOICE then
			if ReceiptInUse('POP Receipt Number' of table POP_ReceiptHist) of form BSP_POP_Receiving_Integration = false then
				set 'POP Receipt Number' of table BSP_Powerhouse_Receiving_TMP to 'POP Receipt Number' of table POP_ReceiptHist;
				change table BSP_Powerhouse_Receiving_TMP;
				set 'Vendor ID' of table BSP_Powerhouse_Receiving_TMP to 'Vendor ID' of table POP_ReceiptHist;
				set 'Vendor Name' of table BSP_Powerhouse_Receiving_TMP to 'Vendor Name' of table POP_ReceiptHist;
				set 'Vendor Document Number' of table BSP_Powerhouse_Receiving_TMP to 'Vendor Document Number' of table POP_ReceiptHist;
				save table BSP_Powerhouse_Receiving_TMP;
			end if;
		end if;
		
		get next table POP_ReceiptHist by POP_RcptHistIdx_DocDateByVendID;
	end while;
	
end if;

fill window BSP_POP_Receiving_Integration_Scrolling table BSP_Powerhouse_Receiving_TMP;"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration l_Send to Powerhouse_CHG"		
		{
			Documentation	""
			Script	"local integer 				nStatus;
local long 					lSequenceNumber = 16384;
local 'Error Message Text' 	l_ErrorMessage;

if empty(BSP_ContainerID) then
	warning \"Please enter the container id\";
	abort script;
end if;

if ask(\"Are you sure you want to send this record to Powerhouse?\", \"Yes\", \"No\", \"\") = ASKBUTTON1 then
	release table BSP_Powerhouse_Receiving_HDR;
	range clear table BSP_Powerhouse_Receiving_HDR;
	clear table BSP_Powerhouse_Receiving_HDR;

	set BSP_ContainerID of table BSP_Powerhouse_Receiving_HDR to BSP_ContainerID;
	change table BSP_Powerhouse_Receiving_HDR;
	copy from window BSP_POP_Receiving_Integration to table BSP_Powerhouse_Receiving_HDR;
	set 'Requested By' of table BSP_Powerhouse_Receiving_HDR to 'User ID' of globals;
	set 'Date Sent' of table BSP_Powerhouse_Receiving_HDR to sysdate();
	set 'Time Sent' of table BSP_Powerhouse_Receiving_HDR to systime();
	save table BSP_Powerhouse_Receiving_HDR;

	{save the line items}
	get first table BSP_Powerhouse_Receiving_TMP;
	while err() = OKAY do
		if BSP_Include of table BSP_Powerhouse_Receiving_TMP = true then
			release table BSP_Powerhouse_Receiving_LINE;
			range clear table BSP_Powerhouse_Receiving_LINE;
			clear table BSP_Powerhouse_Receiving_LINE;
			
			set BSP_ContainerID of table BSP_Powerhouse_Receiving_LINE to BSP_ContainerID;
			set 'POP Receipt Number' of table BSP_Powerhouse_Receiving_LINE to 'POP Receipt Number' of table BSP_Powerhouse_Receiving_TMP;
			change table BSP_Powerhouse_Receiving_LINE;
			copy from table BSP_Powerhouse_Receiving_TMP to table BSP_Powerhouse_Receiving_LINE;
			save table BSP_Powerhouse_Receiving_LINE;
		end if;
		get next table BSP_Powerhouse_Receiving_TMP;
	end while;

	call SendToPowerhouse of form BSP_POP_Receiving_Integration, BSP_ContainerID, nStatus, l_ErrorMessage;
	
	if nStatus = OKAY then
		warning \"Record has been successfully sent to Powerhouse.\";
		remove range table BSP_Powerhouse_Receiving_TMP;
		restart form;
	else
		warning \"There was an error processing your request. \" + l_ErrorMessage;
		abort script;
	end if;
end if;"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration_Scrolling SCROLL_CHG"		
		{
			Documentation	""
			Script	"release table BSP_Powerhouse_Receiving_TMP;
range clear table BSP_Powerhouse_Receiving_TMP;
clear table BSP_Powerhouse_Receiving_TMP;

set 'POP Receipt Number' of table BSP_Powerhouse_Receiving_TMP to 'POP Receipt Number' of window BSP_POP_Receiving_Integration_Scrolling;
change table BSP_Powerhouse_Receiving_TMP;
copy from window BSP_POP_Receiving_Integration_Scrolling to table BSP_Powerhouse_Receiving_TMP;
save table BSP_Powerhouse_Receiving_TMP;"
			UserProperties	""
		}
		EventScript	"BSP_POP_Receiving_Integration_WIN_PRE"		
		{
			Documentation	""
			Script	"set '(L) DocumentFilter' to 1;

show '(L) ReceiptFrom';
show '(L) ReceiptTo';
show 'Lookup Button 1';
show 'Lookup Button 2';
hide '(L) VendorDocNumFrom';
hide '(L) VendorDocNumTo';
hide '(L) DocumentDateFrom';
hide '(L) DocumentDateTo';
"
			UserProperties	""
		}
	}
	~Functions
	{
		Function	"ReceiptInUse"		
		{
			Documentation	""
			Script	"function returns boolean bInUse;

in 'POP Receipt Number' in_ReceiptNumber;

release table BSP_Powerhouse_Receiving_LINE;
range clear table BSP_Powerhouse_Receiving_LINE;
clear table BSP_Powerhouse_Receiving_LINE;

set 'POP Receipt Number' of table BSP_Powerhouse_Receiving_LINE to in_ReceiptNumber;
range start table BSP_Powerhouse_Receiving_LINE by BSP_Powerhouse_Receiving_LINE_Key2;
set 'POP Receipt Number' of table BSP_Powerhouse_Receiving_LINE to in_ReceiptNumber;
range end table BSP_Powerhouse_Receiving_LINE by BSP_Powerhouse_Receiving_LINE_Key2;

get first table BSP_Powerhouse_Receiving_LINE by BSP_Powerhouse_Receiving_LINE_Key2;
if err() = OKAY then
	bInUse = true;
else
	bInUse = false;
end if;"
			UserProperties	""
		}
	}
	~Procedures
	{
		Procedure	"SendToPowerhouse"		
		{
			Documentation	""
			Script	"in BSP_ContainerID 			in_ContainerID;
out integer					out_Result;
out 'Error Message Text' 	out_ErrorMessageText;"
			UserProperties	""
		}
	}
}
