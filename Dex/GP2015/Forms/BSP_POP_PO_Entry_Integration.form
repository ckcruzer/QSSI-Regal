Form	"BSP_POP_PO_Entry_Integration"
{
	Commands
	{
	}
	ConfigurableMenus	"false"
	Constants
	{
	}
	Datatypes
	{
		Datatype	"Integration Status"		
		{
			AllowOddLength	"false"
			Control	"String"
			Format	""
			KeyableLength	"50"
			StorageLength	"52"
		}
		Datatype	"Send to Powerhouse"		
		{
			Control	"PushButton"
			DefaultDown	"00000"
			DefaultMouseOver	"00000"
			DefaultUp	"00001"
			Prompt	"Send to Powerhouse"
			PromptDown	""
			PromptMouseOver	""
			StaticType	"Picture"
			~ItemImages
			{
				PictItem	"00001"				
				{
					Item	"WindowToolbar_Transfer_PB_Up"
				}
			}
		}
	}
	EventPost	""
	EventPre	""
	Fields
	{
		Field	"Integration Status"		
		{
			ArraySize	"0"
			Datatype	"(L) Integration Status"
			LookupForm	""
			PhysicalName	""
		}
		Field	"Send to Powerhouse"		
		{
			ArraySize	"0"
			Datatype	"(L) Send to Powerhouse"
			LookupForm	""
			PhysicalName	""
		}
	}
	Menus
	{
	}
	Series	"Inventory"
	Tables
	{
		FormTable	"BSP_Powerhouse_PO_Transfer"		
		{
			AutoOpen	"false"
			CursorBlockSize	"0"
			OpenMode	"ReadWrite"
			Position	"1"
			Table	"BSP_Powerhouse_PO_Transfer"
		}
	}
	Windows
	{
		Window	"BSP_POP_PO_Entry_Integration"		
		{
			AutoLinkTable	""
			AutoOpen	"true"
			BackGround	"true"
			CloseBox	"true"
			ControlArea	"true"
			DisplayName	"Powerhouse Purchase Order Integration"
			EventActivate	""
			EventContextMenu	""
			EventPost	""
			EventPre	"BSP_POP_PO_Entry_Integration_WIN_PRE"
			EventPrint	""
			Fields
			{
				WindowControl	"(L) Send to Powerhouse"				
				{
					Alignment	"center"
					Appearance	"3D Highlight"
					BackColor	"System - Toolbar"
					Border	"true"
					ButtonStyle	"TextOnRight"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_POP_PO_Entry_Integration l_Send to Powerhouse_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) Send to Powerhouse"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"0"
					PositionTop	"0"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"24"
					SizeWidth	"144"
					TabStop	"true"
					Tag	"4"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"1"
					Zoom	"false"
				}
				WindowLine	"1"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"0"
					PositionTop	"24"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"0"
					SizeWidth	"640"
					ZOrder	"0"
				}
				WindowPrompt	"17"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"112"
					Text	"PO Number"
					Visible	"true"
					ZOrder	"9"
					Zoom	"false"
				}
				WindowPrompt	"18"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"296"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"112"
					Text	"Date Sent"
					Visible	"true"
					ZOrder	"10"
					Zoom	"false"
				}
				WindowPrompt	"19"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"296"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"112"
					Text	"Time Sent"
					Visible	"true"
					ZOrder	"11"
					Zoom	"false"
				}
				WindowPrompt	"20"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"72"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"112"
					Text	"Requested By"
					Visible	"true"
					ZOrder	"12"
					Zoom	"false"
				}
				WindowPrompt	"21"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"91"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"112"
					Text	"Error Message Text"
					Visible	"true"
					ZOrder	"13"
					Zoom	"false"
				}
				WindowLine	"23"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"218"
					PositionTop	"3"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"16"
					SizeWidth	"0"
					ZOrder	"15"
				}
				WindowLine	"5"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"144"
					PositionTop	"3"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"16"
					SizeWidth	"0"
					ZOrder	"2"
				}
				WindowPrompt	"6"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"112"
					Text	"Status Code"
					Visible	"true"
					ZOrder	"3"
					Zoom	"false"
				}
				WindowControl	"Cancel Button"				
				{
					Alignment	"center"
					Appearance	"3D Highlight"
					BackColor	"System - Toolbar"
					Border	"true"
					ButtonStyle	"TextOnRight"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_POP_PO_Entry_Integration Cancel Button_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Cancel Button"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"146"
					PositionTop	"0"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"24"
					SizeWidth	"72"
					TabStop	"true"
					Tag	"11"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"4"
					Zoom	"false"
				}
				WindowControl	"Date Sent"				
				{
					Appearance	"2D Border"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"Date"
					DisableLookup	"false"
					Editable	"false"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Date Sent"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"408"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"13"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"5"
					Zoom	"false"
				}
				WindowControl	"Display Existing Record"				
				{
					Alignment	"left"
					Appearance	"3D Border"
					AutoCopy	"true"
					BackColor	"Yellow"
					Border	"true"
					ButtonStyle	"Standard"
					ControlType	"CheckBox"
					Editable	"true"
					EventChange	"BSP_POP_PO_Entry_Integration Display Existing Record_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Display Existing Record"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PatternSelect	"50% Shading"
					PositionLeft	"24"
					PositionTop	"167"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"144"
					TabStop	"true"
					Tag	"22"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"false"
					ZOrder	"14"
				}
				WindowControl	"Error Message Text"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"false"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Error Message Text"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"120"
					PositionTop	"91"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"416"
					TabStop	"true"
					Tag	"16"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"8"
					Zoom	"false"
				}
				WindowControl	"PO Number"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"false"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"PO Number"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"120"
					PositionTop	"34"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"24"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"16"
					Zoom	"false"
				}
				WindowControl	"Requested By"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"false"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Requested By"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"120"
					PositionTop	"72"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"15"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"7"
					Zoom	"false"
				}
				WindowControl	"Status Code"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"false"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Status Code"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"120"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"25"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"17"
					Zoom	"false"
				}
				WindowControl	"Time Sent"				
				{
					Appearance	"2D Border"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"Time"
					DisableLookup	"false"
					Editable	"false"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"Time Sent"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"408"
					PositionTop	"53"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"128"
					TabStop	"true"
					Tag	"14"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"6"
					Zoom	"false"
				}
			}
			LastTag	"25"
			Position	"1"
			PositionLeft	"1"
			PositionTop	"1"
			Resizable	"true"
			SizeHeight	"121"
			SizeWidth	"546"
			WindowType	"Primary"
		}
	}
	~EventScripts
	{
		EventScript	"BSP_POP_PO_Entry_Integration Cancel Button_CHG"		
		{
			Documentation	""
			Script	"close form BSP_POP_PO_Entry_Integration;"
			UserProperties	""
		}
		EventScript	"BSP_POP_PO_Entry_Integration Display Existing Record_CHG"		
		{
			Documentation	""
			Script	"release table BSP_Powerhouse_PO_Transfer;
range clear table BSP_Powerhouse_PO_Transfer;
clear table BSP_Powerhouse_PO_Transfer;

set 'PO Number' of table BSP_Powerhouse_PO_Transfer to 'PO Number';
get table BSP_Powerhouse_PO_Transfer;
if err() = OKAY then
	copy from table BSP_Powerhouse_PO_Transfer to window BSP_POP_PO_Entry_Integration of form BSP_POP_PO_Entry_Integration;
	set 'Display Existing Record' to true;
end if;	"
			UserProperties	""
		}
		EventScript	"BSP_POP_PO_Entry_Integration l_Send to Powerhouse_CHG"		
		{
			Documentation	""
			Script	"local integer				nStatus;
local 'Error Message Text' 	l_ErrorMessage;

if ask(\"Are you sure you want to send this record to Powerhouse?\", \"Yes\", \"No\", \"\") = ASKBUTTON1 then
	call SendToPowerhouse of form BSP_POP_PO_Entry_Integration, 'PO Number', nStatus, l_ErrorMessage;
	
	if nStatus = OKAY then
		warning \"Record has been successfully sent to Powerhouse.\";
	else
		warning \"There was an error processing your request. \" + l_ErrorMessage;
		abort script;
	end if;
	
	run script 'Display Existing Record';
end if;


"
			UserProperties	""
		}
		EventScript	"BSP_POP_PO_Entry_Integration_WIN_PRE"		
		{
			Documentation	""
			Script	"run script 'Display Existing Record';"
			UserProperties	""
		}
	}
	~Functions
	{
	}
	~Procedures
	{
		Procedure	"SendToPowerhouse"		
		{
			Documentation	""
			Script	"in 'PO Number'  			in_PONumber;
out integer					out_Result;
out 'Error Message Text' 	out_ErrorMessageText;"
			UserProperties	""
		}
	}
}
