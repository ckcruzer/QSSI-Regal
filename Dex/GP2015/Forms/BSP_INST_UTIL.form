Form	"BSP_INST_UTIL"
{
	Commands
	{
	}
	ConfigurableMenus	"false"
	Constants
	{
	}
	Datatypes
	{
		Datatype	"CrtTables"		
		{
			Control	"PushButton"
			DefaultDown	"00000"
			DefaultMouseOver	"00000"
			DefaultUp	"00000"
			Prompt	"Create Tables"
			PromptDown	""
			PromptMouseOver	""
			StaticType	"Picture"
			~ItemImages
			{
			}
		}
		Datatype	"Progress"		
		{
			Control	"ProgressIndicator"
		}
		Datatype	"PushButton3"		
		{
			Control	"PushButton"
			DefaultDown	"00000"
			DefaultMouseOver	"00000"
			DefaultUp	"00000"
			Prompt	""
			PromptDown	""
			PromptMouseOver	""
			StaticType	"Picture"
			~ItemImages
			{
			}
		}
		Datatype	"Update Tables"		
		{
			Control	"PushButton"
			DefaultDown	"00000"
			DefaultMouseOver	"00000"
			DefaultUp	"00000"
			Prompt	"Update Tables"
			PromptDown	""
			PromptMouseOver	""
			StaticType	"Picture"
			~ItemImages
			{
			}
		}
	}
	EventPost	""
	EventPre	""
	Fields
	{
		Field	"CrtTables"		
		{
			ArraySize	"0"
			Datatype	"(L) CrtTables"
			LookupForm	""
			PhysicalName	""
		}
		Field	"Progress"		
		{
			ArraySize	"0"
			Datatype	"(L) Progress"
			LookupForm	""
			PhysicalName	""
		}
		Field	"PushButton3"		
		{
			ArraySize	"0"
			Datatype	"(L) PushButton3"
			LookupForm	""
			PhysicalName	""
		}
		Field	"Update Tables"		
		{
			ArraySize	"0"
			Datatype	"(L) Update Tables"
			LookupForm	""
			PhysicalName	""
		}
	}
	Menus
	{
	}
	Series	"3rdParty"
	Tables
	{
	}
	Windows
	{
		Window	"BSP_INST_UTIL"		
		{
			AutoLinkTable	""
			AutoOpen	"true"
			BackGround	"true"
			CloseBox	"true"
			ControlArea	"true"
			DisplayName	"Installation Utilities"
			EventActivate	""
			EventContextMenu	""
			EventPost	""
			EventPre	""
			EventPrint	""
			Fields
			{
				WindowControl	"(L) CrtTables"				
				{
					Alignment	"center"
					Appearance	"3D Border"
					BackColor	"System - Button Face"
					Border	"true"
					ButtonStyle	"TextOnly"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_INST_UTIL l_CrtTables_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) CrtTables"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"408"
					PositionTop	"34"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"24"
					SizeWidth	"200"
					TabStop	"true"
					Tag	"72"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"4"
					Zoom	"false"
				}
				WindowControl	"(L) Progress"				
				{
					Appearance	"3D Border"
					BackColor	"System - Button Face"
					Border	"true"
					ControlType	"ProgressIndicator"
					Direction	"LeftToRight"
					Field	"(L) Progress"
					IndicatorColor	"System - Highlight"
					LinkedPrompt	"0"
					PositionLeft	"2"
					PositionTop	"115"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"608"
					Style	"Solid"
					Tag	"87"
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"9"
				}
				WindowControl	"(L) Update Tables"				
				{
					Alignment	"center"
					Appearance	"3D Border"
					BackColor	"System - Button Face"
					Border	"true"
					ButtonStyle	"TextOnly"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_INST_UTIL l_Update Tables_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"(L) Update Tables"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"408"
					PositionTop	"60"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"24"
					SizeWidth	"200"
					TabStop	"true"
					Tag	"83"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"5"
					Zoom	"false"
				}
				WindowLine	"55"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"0"
					PositionTop	"109"
					ResizeHoriz	"StayLeftGrow"
					ResizeVert	"StayBottom"
					SizeHeight	"0"
					SizeWidth	"645"
					ZOrder	"0"
				}
				WindowLine	"57"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"72"
					PositionTop	"3"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"16"
					SizeWidth	"0"
					ZOrder	"1"
				}
				WindowLine	"62"				
				{
					Appearance	"3D Border"
					LineColor	"System"
					LineSize	"1"
					PositionLeft	"0"
					PositionTop	"24"
					ResizeHoriz	"Grow"
					ResizeVert	"StayTop"
					SizeHeight	"0"
					SizeWidth	"661"
					ZOrder	"2"
				}
				WindowPicture	"89"				
				{
					BackColor	"White"
					Picture	"BSP_Logo"
					PositionLeft	"8"
					PositionTop	"34"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"56"
					SizeWidth	"384"
					Tag	"89"
					ZOrder	"10"
				}
				WindowControl	"OK Button"				
				{
					Alignment	"center"
					Appearance	"3D Highlight"
					BackColor	"System - Toolbar"
					Border	"true"
					ButtonStyle	"TextOnRight"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					EventChange	"BSP_INST_UTIL OK Button_CHG"
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"OK Button"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"0"
					PositionTop	"0"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"24"
					SizeWidth	"72"
					TabStop	"true"
					Tag	"71"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"3"
					Zoom	"false"
				}
				WindowControl	"gpCommonField"				
				{
					Alignment	"left"
					Appearance	"3D Border"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					ControlType	"ListBox"
					DefaultDblClick	"false"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"gpCommonField"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"648"
					PositionTop	"186"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					ShowPartialItems	"true"
					SizeHeight	"95"
					SizeWidth	"112"
					TabStop	"true"
					Tag	"84"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"6"
				}
				WindowControl	"gpNewFieldList"				
				{
					Alignment	"left"
					Appearance	"3D Border"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					ControlType	"ListBox"
					DefaultDblClick	"false"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"gpNewFieldList"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"168"
					PositionTop	"186"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					ShowPartialItems	"true"
					SizeHeight	"95"
					SizeWidth	"112"
					TabStop	"true"
					Tag	"85"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"7"
				}
				WindowControl	"gpOldFieldList"				
				{
					Alignment	"left"
					Appearance	"3D Border"
					AutoCopy	"true"
					BackColor	"System - Window Background"
					ControlType	"ListBox"
					DefaultDblClick	"false"
					DisableLookup	"false"
					Editable	"true"
					EventChange	""
					EventContextMenu	""
					EventMouseEnter	""
					EventMouseExit	""
					EventOther	""
					EventPost	""
					EventPre	""
					Field	"gpOldFieldList"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"40"
					PositionTop	"186"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					ShowPartialItems	"true"
					SizeHeight	"95"
					SizeWidth	"112"
					TabStop	"true"
					Tag	"86"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"8"
				}
			}
			LastTag	"89"
			Position	"1"
			PositionLeft	"74"
			PositionTop	"175"
			Resizable	"true"
			SizeHeight	"140"
			SizeWidth	"626"
			WindowType	"Primary"
		}
	}
	~EventScripts
	{
		EventScript	"BSP_INST_UTIL OK Button_CHG"		
		{
			Documentation	""
			Script	"close form BSP_INST_UTIL;"
			UserProperties	""
		}
		EventScript	"BSP_INST_UTIL l_CrtTables_CHG"		
		{
			Documentation	""
			Script	"if  lower('User ID' of globals) <> \"sa\" then
	beep WARNSOUND;
	warning \"Only the system administrator can create tables. Please login as (sa)\";
	abort script;
end if;


call BSP_Setup_SQL_Tables;


		"
			UserProperties	""
		}
		EventScript	"BSP_INST_UTIL l_Update Tables_CHG"		
		{
			Documentation	""
			Script	"local integer dict_id;
local string lOSName,inDB;
local long status;
local long progress;
local integer tableCount;
local integer i;
local string tables[10];

tableCount = 10;

{will be 0 in test mode otherwise as specified in .set file}
dict_id = Runtime_GetCurrentProductID();

progress = 100/tableCount + 1;

tables[1] = \"BSP_Integration_SETP\";
tables[2] = \"BSP_Powerhouse_SO_LNE_Transfer\";
tables[3] = \"BSP_Powerhouse_SO_Log\";
tables[4] = \"BSP_Powerhouse_Item_Transfer\";
tables[5] = \"BSP_Powerhouse_Location_Mapping\";
tables[6] = \"BSP_Powerhouse_Receiving_Transfer\";
tables[7] = \"BSP_Powerhouse_Receiving_HDR\";
tables[8] = \"BSP_Powerhouse_Receiving_LINE\";
tables[9] = \"BSP_Powerhouse_PO_Transfer\";
tables[10] = \"BSP_Powerhouse_Cust_Batch_Mapping\";

for i = 1 to tableCount do
	increment '(L) Progress' by  progress;
    call convert_tables,
	tables[i], {table technical name}
	dict_id;     {dictionary context}
end for;

'(L) Progress' = 100;

warning \"Tables Updated Successfully.\";
'(L) Progress' = 0;

	
	
"
			UserProperties	""
		}
	}
	~Functions
	{
	}
	~Procedures
	{
	}
}
